<?xml version="1.0" encoding="UTF-8"?>
<CustomObject xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionOverrides>
        <actionName>Accept</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>CancelEdit</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Clone</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Delete</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Edit</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>List</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>New</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>SaveEdit</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>Tab</actionName>
        <type>Default</type>
    </actionOverrides>
    <actionOverrides>
        <actionName>View</actionName>
        <type>Default</type>
    </actionOverrides>
    <allowInChatterGroups>false</allowInChatterGroups>
    <compactLayoutAssignment>SYSTEM</compactLayoutAssignment>
    <deploymentStatus>Deployed</deploymentStatus>
    <description>List object that will enable workflows based on hierarchical properties.</description>
    <enableActivities>false</enableActivities>
    <enableBulkApi>true</enableBulkApi>
    <enableChangeDataCapture>false</enableChangeDataCapture>
    <enableEnhancedLookup>true</enableEnhancedLookup>
    <enableFeeds>false</enableFeeds>
    <enableHistory>false</enableHistory>
    <enableReports>true</enableReports>
    <enableSearch>true</enableSearch>
    <enableSharing>true</enableSharing>
    <enableStreamingApi>true</enableStreamingApi>
    <fields>
        <fullName>Code_1__c</fullName>
        <externalId>false</externalId>
        <label>Code 1</label>
        <length>100</length>
        <required>false</required>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>Code_2__c</fullName>
        <externalId>false</externalId>
        <label>Code 2</label>
        <length>100</length>
        <required>false</required>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>Code_3__c</fullName>
        <externalId>false</externalId>
        <label>Code 3</label>
        <length>100</length>
        <required>false</required>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>Description__c</fullName>
        <externalId>false</externalId>
        <label>Description</label>
        <required>false</required>
        <trackTrending>false</trackTrending>
        <type>TextArea</type>
    </fields>
    <fields>
        <fullName>Is_Exception__c</fullName>
        <defaultValue>false</defaultValue>
        <externalId>false</externalId>
        <label>Is Exception</label>
        <trackTrending>false</trackTrending>
        <type>Checkbox</type>
    </fields>
    <fields>
        <fullName>Language__c</fullName>
        <externalId>false</externalId>
        <label>Language</label>
        <required>false</required>
        <trackTrending>false</trackTrending>
        <type>Picklist</type>
        <valueSet>
            <valueSetDefinition>
                <sorted>false</sorted>
                <value>
                    <fullName>English</fullName>
                    <default>false</default>
                    <label>English</label>
                </value>
                <value>
                    <fullName>French</fullName>
                    <default>false</default>
                    <label>French</label>
                </value>
                <value>
                    <fullName>German</fullName>
                    <default>false</default>
                    <label>German</label>
                </value>
                <value>
                    <fullName>ZZ - Field Not Used</fullName>
                    <default>false</default>
                    <label>ZZ - Field Not Used</label>
                </value>
            </valueSetDefinition>
        </valueSet>
    </fields>
    <fields>
        <fullName>Legacy_One_DuPont_SFID__c</fullName>
        <caseSensitive>true</caseSensitive>
        <description>This field is populated with the legacy One DuPont SF ID and was used during the split to map related records during the split and insert process to maintain the migrated recordâ€™s parent child record relationships.</description>
        <externalId>true</externalId>
        <inlineHelpText>This is the pre-split original 18 digit Salesforce ID of this record that came from the original One Dupont Salesforce instance before the business units were separated. Its is case sensitive and unique.</inlineHelpText>
        <label>Legacy One DuPont SFID</label>
        <length>18</length>
        <required>false</required>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>true</unique>
    </fields>
    <fields>
        <fullName>Level__c</fullName>
        <externalId>false</externalId>
        <label>Level</label>
        <precision>2</precision>
        <required>false</required>
        <scale>0</scale>
        <trackTrending>false</trackTrending>
        <type>Number</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>Owning_Org__c</fullName>
        <externalId>false</externalId>
        <label>Owning Org</label>
        <required>false</required>
        <trackTrending>false</trackTrending>
        <type>Picklist</type>
        <valueSet>
            <valueSetDefinition>
                <sorted>false</sorted>
                <value>
                    <fullName>DPT-Aramids</fullName>
                    <default>false</default>
                    <label>DPT-Aramids</label>
                </value>
                <value>
                    <fullName>P&amp;IP-DLPS</fullName>
                    <default>false</default>
                    <label>P&amp;IP-DLPS</label>
                </value>
                <value>
                    <fullName>DCF FLCH-Refrigerants</fullName>
                    <default>false</default>
                    <label>DCF FLCH-Refrigerants</label>
                </value>
                <value>
                    <fullName>ZZ - Field Not Used</fullName>
                    <default>false</default>
                    <label>ZZ - Field Not Used</label>
                </value>
            </valueSetDefinition>
        </valueSet>
    </fields>
    <fields>
        <fullName>Parent_Name__c</fullName>
        <deleteConstraint>SetNull</deleteConstraint>
        <externalId>false</externalId>
        <label>Parent Name</label>
        <referenceTo>List__c</referenceTo>
        <relationshipName>Lists</relationshipName>
        <required>false</required>
        <trackTrending>false</trackTrending>
        <type>Lookup</type>
    </fields>
    <fields>
        <fullName>Subtype__c</fullName>
        <externalId>false</externalId>
        <label>Subtype</label>
        <required>false</required>
        <trackTrending>false</trackTrending>
        <type>Picklist</type>
        <valueSet>
            <valueSetDefinition>
                <sorted>false</sorted>
                <value>
                    <fullName>TBD</fullName>
                    <default>false</default>
                    <label>TBD</label>
                </value>
                <value>
                    <fullName>ZZ - Field Not Used</fullName>
                    <default>false</default>
                    <label>ZZ - Field Not Used</label>
                </value>
            </valueSetDefinition>
        </valueSet>
    </fields>
    <fields>
        <fullName>Type__c</fullName>
        <externalId>false</externalId>
        <label>Type</label>
        <required>false</required>
        <trackTrending>false</trackTrending>
        <type>Picklist</type>
        <valueSet>
            <valueSetDefinition>
                <sorted>false</sorted>
                <value>
                    <fullName>Equipment Model</fullName>
                    <default>false</default>
                    <label>Equipment Model</label>
                </value>
                <value>
                    <fullName>Geography</fullName>
                    <default>false</default>
                    <label>Geography</label>
                </value>
                <value>
                    <fullName>Instruction URL</fullName>
                    <default>false</default>
                    <label>Instruction URL</label>
                </value>
                <value>
                    <fullName>Quantity Matrix</fullName>
                    <default>false</default>
                    <label>Quantity Matrix</label>
                </value>
                <value>
                    <fullName>Revenue Schedule Product</fullName>
                    <default>false</default>
                    <label>Revenue Schedule Product</label>
                </value>
                <value>
                    <fullName>Segment</fullName>
                    <default>false</default>
                    <label>Segment</label>
                </value>
                <value>
                    <fullName>ZZ - Field Not Used</fullName>
                    <default>false</default>
                    <label>ZZ - Field Not Used</label>
                </value>
            </valueSetDefinition>
        </valueSet>
    </fields>
    <fields>
        <fullName>Website__c</fullName>
        <externalId>false</externalId>
        <label>Website</label>
        <required>false</required>
        <trackTrending>false</trackTrending>
        <type>Url</type>
    </fields>
    <label>List</label>
    <listViews>
        <fullName>List_With_Owning_Org</fullName>
        <columns>NAME</columns>
        <columns>Owning_Org__c</columns>
        <columns>RECORDTYPE</columns>
        <columns>Code_1__c</columns>
        <columns>Code_2__c</columns>
        <columns>Code_3__c</columns>
        <filterScope>Everything</filterScope>
        <label>List With Owning Org</label>
        <language>en_US</language>
    </listViews>
    <nameField>
        <label>List Name</label>
        <type>Text</type>
    </nameField>
    <pluralLabel>Lists</pluralLabel>
    <recordTypes>
        <fullName>eWarranty</fullName>
        <active>true</active>
        <label>eWarranty</label>
        <picklistValues>
            <picklist>Language__c</picklist>
            <values>
                <fullName>English</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>French</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>German</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>ZZ - Field Not Used</fullName>
                <default>false</default>
            </values>
        </picklistValues>
        <picklistValues>
            <picklist>Owning_Org__c</picklist>
            <values>
                <fullName>DCF FLCH-Refrigerants</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>DPT-Aramids</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>P%26IP-DLPS</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>ZZ - Field Not Used</fullName>
                <default>false</default>
            </values>
        </picklistValues>
        <picklistValues>
            <picklist>Subtype__c</picklist>
            <values>
                <fullName>TBD</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>ZZ - Field Not Used</fullName>
                <default>false</default>
            </values>
        </picklistValues>
        <picklistValues>
            <picklist>Type__c</picklist>
            <values>
                <fullName>Equipment Model</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>Geography</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>Instruction URL</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>Quantity Matrix</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>Revenue Schedule Product</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>Segment</fullName>
                <default>false</default>
            </values>
            <values>
                <fullName>ZZ - Field Not Used</fullName>
                <default>false</default>
            </values>
        </picklistValues>
    </recordTypes>
    <searchLayouts/>
    <sharingModel>ReadWrite</sharingModel>
    <visibility>Public</visibility>
    <webLinks>
        <fullName>Email_to_me</fullName>
        <availability>online</availability>
        <displayType>button</displayType>
        <linkType>javascript</linkType>
        <masterLabel>Email to me</masterLabel>
        <openType>onClickJavaScript</openType>
        <protected>false</protected>
        <url>//////////////////////////////
// START OF SCRIPTS LOADING
//////////////////////////////
//
// Load of all Initial required scripts.
//

{!REQUIRESCRIPT(&quot;/soap/ajax/12.0/connection.js&quot;)};
{!REQUIRESCRIPT(&quot;/js/functions.js&quot;)};

//
// Declaration of all standard functions.
//

function fillifempty(strInputCode){
var strTagStrippedText = strInputCode;
strTagStrippedText = strTagStrippedText.replace(&quot;&lt;td&gt;&lt;/td&gt;&quot;,&quot;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&quot;);
return strTagStrippedText;
}


function HTMLclean(strInputCode){
var strTagStrippedText = strInputCode;
strTagStrippedText = strTagStrippedText.replace(&quot;sfdcPage.setHelp(&apos;&quot;,&quot;&lt;&quot;);
strTagStrippedText = strTagStrippedText.replace(&quot;&apos;);&quot;,&quot;&gt;&quot;);
//strTagStrippedText = strTagStrippedText.replace(/&lt;br&gt;-/,&quot;252&quot;);
strTagStrippedText = strTagStrippedText.replace(/&lt;br&gt;/g,&quot;252&quot;);
strTagStrippedText = strTagStrippedText.replace(/&lt;\/?[^&gt;]+(&gt;|$)/g, &quot;&quot;);
strTagStrippedText = strTagStrippedText.replace(&quot;[Change]&quot;,&quot;&quot;);
strTagStrippedText = strTagStrippedText.replace(&quot;[View Org Chart]&quot;,&quot;&quot;);
strTagStrippedText = strTagStrippedText.replace(/252/g,&quot;&lt;br&gt;&quot;);
return strTagStrippedText;
}


//
// Declaration of all non-local variables.
//

var ELE_COLSPAN = &apos;&apos;;
var COLOR_C = &apos;#003F77&apos;;
var COLORTEXT_C = &apos;#FFFFFF&apos;;
var OBJECT_C = &apos;Plan&apos;;
var ELE_INCREMENT = 0;
var RELATED_PRINT = &quot;&quot;;
var RELATED_BODY_INFO = &quot;&quot;;

var BODYDIV= document.getElementById(&apos;ep&apos;).getElementsByTagName(&apos;div&apos;);
var RELATED_DIV = document.getElementsByTagName(&quot;div&quot;);
var pbBody;
var pbSubDIV;
var pbBodyIterator;

var modifier = 0;
var linecount = 0;
var BODY_INFO = &apos;&apos;;
var SIZEFONT=&apos;normal&apos;;


var FOOTER_INFO = &apos;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;table width=&quot;600&quot;&gt;&lt;tr&gt;&lt;td&gt;&lt;a href=&quot;&apos;+window.location.href+&apos;&quot;&gt;To get more information on this plan&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&apos;;


var HEADER_INFO = &quot;&lt;table width=&apos;600px&apos; cellpadding=&apos;0px&apos; cellspacing=&apos;0px&apos;&gt;&lt;tr height=&apos;41px&apos;&gt;&lt;td width=&apos;470px&apos; bgcolor=&apos;#003F77&apos; style=&apos;border-left:1px solid black;border-top:1px solid black;&apos;&gt;&lt;div style=&apos;font-family:arial;color:#FFFFFF;size:18px;font-weight:bolder;margin-left:10px&apos;&gt;&quot;+OBJECT_C+&quot;&lt;/div&gt;&lt;/td&gt;&lt;td width=&apos;130&apos; style=&apos;border-right:1px solid black;border-top:1px solid black;&apos;&gt;&lt;img src=&apos;http://www2.dupont.com/globalassets/v3/images/dupontLogoOnWhite.gif&apos;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan=&apos;2&apos; width=&apos;600px&apos; style=&apos;border-left:1px solid black;border-right:1px solid black;border-bottom:1px solid black;&apos;&gt;&quot;;


//
// SPECIFIC - Code that will search for an plan summary and output a value depending on result of request.
//
//
// Declaration of local variables.
//

var SUMMARY_PLAN = &quot;&lt;div style=&apos;font-family:arial;font-size:10px;margin-right:5px;font-weight:normal&apos;&gt;No Summary has been entered for this Plan,&lt;br&gt; To fill this section, simply add a Plan Summary picture file in the Note and Attachment section of this plan&lt;/div&gt; &quot;;
var entryrequest = &quot;Select ID from Attachment where ParentID = &apos;{!Plan__c.Id}&apos; and (Name LIKE &apos;%Plan Summary%&apos; or Name LIKE &apos;%Plan_Summary%&apos; ) Limit 1&quot;;
var RELATED_PRINT_ADDITION = &quot;&quot;;
var result = sforce.connection.query(entryrequest);
var records = result.getArray(&quot;records&quot;);

// *Specific

//////////////////////////////
// END OF SCRIPTS LOADING
//////////////////////////////
//
//
//
//////////////////////////////
// Start OF MAIN BODY ANALYSIS
//////////////////////////////

//
// GENERIC - Execution of code ... Result is SUMMARY_PLAN which will be integrated as a result at the end of the S-Control
//

if(records.length &gt;= 1){
SUMMARY_PLAN = &apos;&apos;;
for (var i = 0; i&lt;records.length; i++){
var Plan = records[i];
SUMMARY_PLAN += &quot;&lt;a href=&apos;https://www.salesforce.com/servlet/servlet.FileDownload?file=&quot;+Plan.Id+&quot;&apos; target=&apos;_blank&apos;&gt;&lt;div style=&apos;font-family:arial;font-size:10px;margin-right:5px;font-weight:normal;&apos;&gt;View the Plan Summary&lt;div&gt;&lt;/a&gt;&quot;;
}
}

//
// GENERIC - Code that will iterate on the first level component pbBody.
// pbBody represents the sections on the page ...
// the first one is the object detail.
// the rest are sub sections.
//


for ( var i = 0; i &lt; BODYDIV.length; i++){
if (BODYDIV.item(i).className == &quot;pbBody&quot;) {
pbBody = BODYDIV.item(i);
pbBodyIterator = pbBody.getElementsByTagName(&apos;div&apos;);


for ( var b = 0; b &lt; pbBodyIterator.length; b++){
if (pbBodyIterator.item(b).className == &quot;pbSubsection&quot; ) {
stopit = false;
if(ELE_INCREMENT == 0){
BODY_INFO += &quot;&lt;table width=&apos;600&apos;&gt;&lt;tr&gt;&lt;td colspan=&apos;4&apos; bgcolor=&apos;&quot;+COLOR_C+&quot;&apos;&gt;&lt;span style=&apos;font-family:arial;color:&quot;+COLORTEXT_C+&quot;;font-weight: bold;&apos; &gt;&quot;+OBJECT_C+&quot; details&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&quot;;
ELE_INCREMENT ++;
}else{
subdivisiontitle = pbBodyIterator.item(b-1).getElementsByTagName(&apos;h3&apos;);
for ( var ge = 0; ge &lt; subdivisiontitle.length; ge++){

//
// Specific - Define the subsections you would like to remove.
//

if(subdivisiontitle.item(ge).innerHTML.match(&apos;Custom Links&apos;)){
stopit = true;
}else{
texto = subdivisiontitle.item(ge).innerHTML;
BODY_INFO += &quot;&lt;tr&gt;&lt;td style=&apos;vertical-align:top&apos; colspan=&apos;4&apos; bgcolor=&apos;&quot;+COLOR_C+&quot;&apos;&gt;&lt;span style=&apos;font-family:arial;color:&quot;+COLORTEXT_C+&quot;;font-weight: bold;&apos; &gt;&quot;+texto+&quot;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&quot;;
}
}
}

//
// GENERIC - Code that will iterate on the TR and TD component of sections and subsections.
// pbBody represents the sections on the page ...
// the first one is the object detail.
// the rest are sub sections.
//


pbBodyTRIterator = pbBodyIterator.item(b).getElementsByTagName(&apos;tr&apos;);

for ( var z = 0; z &lt; pbBodyTRIterator.length; z++){
BODY_INFO += &quot;&lt;tr&gt;&quot;;
linecount = 0;

pbBodyTDIterator = pbBodyTRIterator.item(z).getElementsByTagName(&apos;td&apos;);
for ( var x = 0; x &lt; pbBodyTDIterator.length; x++){
tdspanmod = 5 - pbBodyTDIterator.length;


if(pbBodyTDIterator.item(x).className != &apos;helpButton&apos; &amp;&amp; stopit == false){
linecount ++;
if(linecount == 1 || linecount == 3){
SIZEFONT=&apos;bold&apos;;
}else{
SIZEFONT=&apos;normal&apos;;
}


//
// Specific - Define the part you would like to remove.
//

if(pbBodyTDIterator.item(x).innerHTML.match(&apos;Custom Links&apos;)){
stopit = true;
}

if(x == pbBodyTDIterator.length-1){
DISPLAY_WIDTH = tdspanmod * 150;
if(pbBodyTDIterator.item(x).innerHTML.match(&apos;document.forms&apos;)){

BODY_INFO += fillifempty(&apos;&lt;td style=&quot;vertical-align:top&quot; colspan=&quot; &apos;+tdspanmod+&apos;&quot; width=&quot;&apos;+DISPLAY_WIDTH+&apos;px&quot;&gt;&apos;+SUMMARY_PLAN+&apos;&lt;/td&gt;&apos;);
ELE_COLSPAN += pbBodyTDIterator.item(x).getAttribute(&apos;colspan&apos;);

// *Specific


}else{

BODY_INFO += fillifempty(&apos;&lt;td style=&quot;vertical-align:top&quot; colspan=&quot; &apos;+tdspanmod+&apos;&quot; width=&quot; &apos;+DISPLAY_WIDTH+&apos;px&quot;&gt;&lt;div style=&quot;font-family:arial;font-size:10px;margin-right:5px;&quot;&gt;&apos;+HTMLclean(pbBodyTDIterator.item(x).innerHTML)+&apos;&lt;/div&gt;&lt;/td&gt;&apos;);
ELE_COLSPAN += pbBodyTDIterator.item(x).getAttribute(&apos;colspan&apos;);
}
}else{
BODY_INFO += fillifempty(&apos;&lt;td colspan=&quot;1&quot; style=&quot;vertical-align:top&quot; width=&quot;150px&quot;&gt;&lt;div style=&quot;font-family:arial;font-size:10px;margin-right:5px;font-weight:&apos;+SIZEFONT+&apos;&quot;&gt;&apos;+HTMLclean(pbBodyTDIterator.item(x).innerHTML)+&apos;&lt;/div&gt;&lt;/td&gt;&apos;);
ELE_COLSPAN += pbBodyTDIterator.item(x).getAttribute(&apos;colspan&apos;);
}
}

}

BODY_INFO += &quot;&lt;/tr&gt;&quot;;
} //TRIterator
} // pbSubsection
} // pbBodyIterator
} // pbBody
} // BODYDIV
BODY_INFO +=&quot;&lt;/table&gt;&quot;;

//////////////////////////////
// END OF MAIN BODY ANALYSIS
//////////////////////////////
//
//
//
//////////////////////////////
// START OF RELATED ANALYSIS
//////////////////////////////

//
// GENERIC - Code that will iterate on the TR and TD component of Related Object.
// DIV will be the main component and within these DIV, iteration is made on tr and tds
//

var NUM_COLSPAN=1;
for (var lvl1 = 0; lvl1 &lt; RELATED_DIV.length; lvl1++){
RELATED_PRINT = &apos;&apos;;
if(RELATED_DIV.item(lvl1).className == &quot;bRelatedList&quot;){
RELATED_DIV_OBJECT = RELATED_DIV.item(lvl1+3).getElementsByTagName(&quot;h3&quot;);
RELATED_TR = RELATED_DIV.item(lvl1+4).getElementsByTagName(&quot;tr&quot;);
if(RELATED_TR.length == 1){
RELATED_PRINT += &quot;&lt;tr&gt;&lt;td&gt;&lt;div style=&apos;font-family:arial;font-size:10px;&apos;&gt;No records to display&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&quot;;
NUM_COLSPAN = 1;
}else{
RELATED_HEADERS = RELATED_TR.item(0).getElementsByTagName(&quot;th&quot;);
RELATED_PRINT += &quot;&lt;tr&gt;&quot;;
NUM_COLSPAN = RELATED_HEADERS.length - 1;
for (var lvl5 = 1; lvl5 &lt; RELATED_HEADERS.length; lvl5++){
RELATED_PRINT += &quot;&lt;td style=&apos;vertical-align:top&apos;&gt;&lt;div style=&apos;font-family:arial;font-size:10px;font-weight: bold;&apos;&gt;&quot;+HTMLclean(RELATED_HEADERS.item(lvl5).innerHTML)+&quot;&lt;/div&gt;&lt;/td&gt;&quot;;
}
RELATED_PRINT += &quot;&lt;/tr&gt;&quot;;
for (var lvl6 = 1; lvl6 &lt; RELATED_TR.length; lvl6++){
RELATED_PRINT += &quot;&lt;tr&gt;&quot;;
RELATED_PRINT += &quot;&lt;td style=&apos;vertical-align:top&apos;&gt;&lt;div style=&apos;font-family:arial;font-size:10px;&apos;&gt;&quot;+HTMLclean(RELATED_TR.item(lvl6).getElementsByTagName(&apos;th&apos;).item(0).innerHTML)+&quot;&lt;/div&gt;&lt;/td&gt;&quot;;
RELATED_TD = RELATED_TR.item(lvl6).getElementsByTagName(&apos;td&apos;);
for (var lvl7 = 1; lvl7 &lt; RELATED_TD.length; lvl7++){
RELATED_PRINT += &quot;&lt;td&gt;&lt;div style=&apos;font-family:arial;font-size:10px;&apos;&gt;&quot;+HTMLclean(RELATED_TD.item(lvl7).innerHTML)+&quot;&lt;/div&gt;&lt;/td&gt;&quot;;
}
RELATED_PRINT += &quot;&lt;/tr&gt;&quot;;
}
}

//
// Specific - If you want to trigger some code on specific related objects.
//

if(RELATED_DIV_OBJECT.item(0).innerHTML.match(&apos;Account Plan Of&apos;)){
RELATED_PRINT_ADDITION= &quot;&lt;tr&gt;&lt;td style=&apos;vertical-align:top&apos; colspan=&apos;4&apos; &gt;&lt;span style=&apos;font-family:arial;font-weight: normal;font-size:10px;&apos;&gt;&lt;a href=&apos;https://www.salesforce.com/00O30000001kxd2?pv0={!Plan__c.Name}&apos;&gt;View all related contacts.&lt;/a&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&quot;;
}else{
RELATED_PRINT_ADDITION= &quot;&quot;;
}

// *Specific


RELATED_BODY_INFO += &quot;&lt;table width=&apos;600px&apos;&gt;&lt;tr&gt;&lt;td style=&apos;vertical-align:top&apos; colspan=&apos;&quot;+NUM_COLSPAN+&quot;&apos; bgcolor=&apos;&quot;+COLOR_C+&quot;&apos;&gt;&lt;span style=&apos;font-family:arial;color:&quot;+COLORTEXT_C+&quot;;font-weight:bold;&apos;&gt;&quot;+RELATED_DIV_OBJECT.item(0).innerHTML+&quot;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&quot;+RELATED_PRINT+RELATED_PRINT_ADDITION+&quot;&lt;/table&gt;&quot;;

}
}

//////////////////////////////
// END OF RELATED ANALYSIS
//////////////////////////////
//
//
//
//////////////////////////////
// SEND EMAIL
//////////////////////////////

alert(&apos;This page has been successfully sent to your email address.&apos;);
var user = sforce.connection.getUserInfo().userEmail;
var singleRequest = new sforce.SingleEmailMessage();
singleRequest.replyTo = user;
singleRequest.subject = &quot;Salesforce.com &quot;+document.title.split(&quot;~&quot;)[0];
singleRequest.htmlBody = HEADER_INFO+BODY_INFO+RELATED_BODY_INFO+FOOTER_INFO;

singleRequest.toAddresses = [user];
var sendMailRes = sforce.connection.sendEmail([singleRequest]);</url>
    </webLinks>
</CustomObject>
