<apex:page controller="ctrlMetadataERD" cache="false" action="{!init}" showheader="false" sidebar="false">
	<apex:includeScript value="{!URLFOR($Resource.Jquery_1_8_11, 'js/jquery-1.5.1.min.js')}" />
<script>

//Submit the email data to Iframe
function renderChart(dot) {
var ifrm = document.getElementById('iframe_result');
    ifrm.style.display="";
    ifrm.scrolling="auto";
    document.forms['chart'].chl.value=dot; //document.getElementById(eDot).value;
    document.forms['chart'].action='https://chart.googleapis.com/chart?chid='+(new Date()).getMilliseconds();
    //document.forms['chart'].action='http://chart.apis.google.com/chart?chid='+(new Date()).getMilliseconds(); 
    document.forms['chart'].submit();
    //ifrm.style.height = (document.body.scrollHeight+20)+"px";
}


    var j$ = jQuery.noConflict();
    j$(document).ready(function() {
		var dot='{!dot}';
		if (dot!='') renderChart('{!dot}');
    });

    function esc(myid) {
           return '#' + myid.replace(/(:|\.)/g,'\\\\$1');
    } 
</script>

<!-- ===================================================================================================== 
This is the Form that get submitted into the target IFRAME
onsubmit - used to prevent caching
=======================================================================================================-->
<form name="chart" method="post" id="chart" action="http://chart.apis.google.com/chart" target="iframe_result">
    <input type="hidden" name="cht" value="gv"  />
    <!--   <input type='hidden' name='chs' value='1000x3000' /> -->
    <input type="hidden" name="chof" value="png" />
    <input type='hidden' name='chl' value=""/>
</form>


<apex:form >

    <apex:actionFunction action="{!getRelations}" name="JSSObj_onChange" rerender="pDot" oncomplete="document.body.style.cursor='auto';">
        <apex:param name="firstParam" assignTo="{!soType}" value="" />
    </apex:actionFunction>
   
   <apex:pageBlock >
   	<apex:pageBlockSection >
   	<apex:pageBlockSectionItem >
	   <apex:outputText value="sObject Type"/>
	   <apex:selectList id="sl" value="{!soType}" multiselect="false" size="1" onchange="javascript:document.body.style.cursor='wait';JSSObj_onChange(this.value);">
	        <apex:selectOptions value="{!sObjects}" /></apex:selectList>
   </apex:pageBlockSectionItem>
   </apex:pageBlockSection>
	</apex:pageBlock>
	
	   <apex:pageBlock />
	   
    <apex:outputPanel id="pDot">
        <script>
            renderChart('{!dot}');
        </script>
     	<br/>
        <!-- ===================================================================================================== 
		IFRAME used to hold content
		=======================================================================================================-->
		<iframe id="iframe_result" name="iframe_result" width="100%" height="3000" noresize="true" scrolling="auto" style="display:none; border:1px solid #E9E8DF;" />
		<span style="color:white"><br/><br/>dotSize:{!dotSize}<br/>{!dot}</span>
    </apex:outputPanel>
   
    
</apex:form>


</apex:page>