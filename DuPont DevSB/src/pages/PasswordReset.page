<apex:page controller="ctrlPasswordReset" showheader="false">
<apex:pagemessages />
<br/>
&nbsp;&nbsp;&nbsp;<apex:image url="{!$Resource.dupontLogoOnWhite}"/>
<br/>
<apex:sectionHeader title="Password Reset" subtitle="OneDuPont CRM"/>  
<apex:form id="frm">

	<apex:outputPanel rendered="{!!hasTried}" layout="block" style="width:500px;">
		<apex:pageBlock id="pb" >
	    	<apex:pageBlockButtons location="bottom">
		        <apex:commandButton id="bResetPassword" value="Reset Password" action="{!resetPassword}" title="Reset Password" rerender="frm" status="{!$Component.saveStatus}"  oncomplete="document.body.style.cursor='auto';"/>
				<apex:actionStatus id="saveStatus" onmousedown="wait(true);"  onstart="wait(true);" onstop="wait(false);" />
					<script>
					function wait(on) {
						document.body.style.cursor = (on) ? 'wait' : 'auto';
						document.getElementById("{!$Component.bResetPassword}").className 	= (on) ? 'btnDisabled' : 'btn';
						return true;
						}	
					</script>
		    </apex:pageBlockButtons>
			<apex:pageBlockSection columns="1">
			<apex:pageBlockSectionItem >
				<apex:outputLabel value="User Name"/>
				<apex:inputText value="{!un}" style="width:250px;"/>
			</apex:pageBlockSectionItem>
				<apex:pageBlockSectionItem >
				<apex:outputLabel value="ePass Id"/>
				<apex:inputText value="{!epass}"/>
			</apex:pageBlockSectionItem>
			</apex:pageBlockSection>
		</apex:pageBlock>
	</apex:outputPanel>
	
	<apex:outputPanel rendered="{!hasTried}">
	
		<apex:outputPanel rendered="{!isNull(sfarName)}">
			<br/>
			<apex:pageBlock id="pbErr" >
			<apex:pageMessage summary="We are unable to process your request. Use the list below to identify and contact your SFDC Key User to request that a SFAR-Password Reset be submitted in Salesforce.com." severity="warning" strength="3" />
			<br/>
			
    <apex:pageBlockSection title="KeyUsers" columns="1">
    <apex:outputPanel layout="block"> 
    <table class="list" cellpadding="0" cellspacing="0" border="0" style="width:100%">
        <thead><tr class="headerRow" style="width:100%">
				<th>Region</th>    
				<th>Business</th>  
				<th>Name</th>  
				<th>Email</th>          
        </tr></thead>
        <tbody>
        <apex:repeat value="{!keyusers}" var="u" id="theRepeat">
            <tr class="dataRow">
				<td><apex:outputfield value="{!u.User_Region__c}"/></td>
				<td><apex:outputfield value="{!u.User_Grouping__c}"/></td>
				<td><apex:outputfield value="{!u.Name}"/></td>
				<td><apex:outputfield value="{!u.Email}"/></td>
            </tr>
        </apex:repeat>
        </tbody>
  </table>
  </apex:outputPanel>
  </apex:pageBlockSection>
  </apex:pageBlock>  
			
		</apex:outputPanel>
		
		<apex:outputPanel rendered="{!!isNull(sfarName)}">
		
			<apex:outputPanel rendered="{!!autoReset}">
				<br/>
				<apex:pageBlock id="pbNotReset" >A password reset request has been sent to your key user. [{!sfarName}]</apex:pageBlock>
			</apex:outputPanel>	
					
			<apex:outputPanel rendered="{!autoReset}" >
				<br/>
				<apex:pageBlock id="pbReset" >Your password has been reset,  you should receive an email shortly.   [{!sfarName}]</apex:pageBlock>
			</apex:outputPanel>	
		
		</apex:outputPanel>		
		

		
	</apex:outputPanel>
	
	
	
</apex:form>
</apex:page>